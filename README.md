# üõ†Ô∏è –í–µ–±-—Å–µ—Ä–≤–∏—Å "–ó–∞—è–≤–∫–∏ –≤ —Ä–µ–º–æ–Ω—Ç–Ω—É—é —Å–ª—É–∂–±—É"

–¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–∏—ë–º–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞—è–≤–æ–∫ –≤ —Ä–µ–º–æ–Ω—Ç–Ω—É—é —Å–ª—É–∂–±—É —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ —Ä–æ–ª—è–º (–¥–∏—Å–ø–µ—Ç—á–µ—Ä/–º–∞—Å—Ç–µ—Ä).

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker –∏ Docker Compose (–∏–ª–∏ Colima –Ω–∞ macOS)
- Git

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/firefirefile/repair-requests
cd repair-requests

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å Colima)
colima start
docker-compose up -d

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
docker-compose exec app composer install
docker-compose exec app cp .env.example .env
docker-compose exec app php artisan key:generate

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥—ã
docker-compose exec app php artisan migrate:fresh --seed

# –ì–æ—Ç–æ–≤–æ! –û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ
open http://localhost:8080
```

## üë• –¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `php artisan migrate:fresh --seed` –≤ —Å–∏—Å—Ç–µ–º–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:

| –†–æ–ª—å | Email | –ü–∞—Ä–æ–ª—å |
|------|-------|--------|
| –î–∏—Å–ø–µ—Ç—á–µ—Ä | `dispatcher@example.com` | `password` |
| –ú–∞—Å—Ç–µ—Ä (–ò–≤–∞–Ω) | `ivan@example.com` | `password` |
| –ú–∞—Å—Ç–µ—Ä (–ü–µ—Ç—Ä) | `petr@example.com` | `password` |

–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ø–∞—Ä–æ–ª—å: **password**

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –≥–æ–Ω–æ–∫ (Race Condition)

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –∑–∞—â–∏—Ç—É –æ—Ç –≥–æ–Ω–æ–∫ –ø—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –∑–∞—è–≤–æ–∫ –º–∞—Å—Ç–µ—Ä–∞–º–∏. –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —ç—Ç–æ–π –∑–∞—â–∏—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –≥–æ–Ω–∫–∏

```bash
# –î–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—É –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
chmod +x race_test.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç (—É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ localhost:8080)
./race_test.sh
```

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–µ—Å—Ç:

1. –õ–æ–≥–∏–Ω –∫–∞–∫ –¥–∏—Å–ø–µ—Ç—á–µ—Ä
2. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–∏
3. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ –º–∞—Å—Ç–µ—Ä—É –ò–≤–∞–Ω—É
4. –í—ã—Ö–æ–¥ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
5. –õ–æ–≥–∏–Ω –∫–∞–∫ –º–∞—Å—Ç–µ—Ä –ò–≤–∞–Ω
6. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ 5 –∑–∞–ø—Ä–æ—Å–æ–≤** –Ω–∞ –≤–∑—è—Ç–∏–µ –∑–∞—è–≤–∫–∏ –≤ —Ä–∞–±–æ—Ç—É
7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

‚úÖ **–¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω**, –µ—Å–ª–∏ –∑–∞—è–≤–∫–∞ –ø–µ—Ä–µ—à–ª–∞ –≤ —Å—Ç–∞—Ç—É—Å "–í —Ä–∞–±–æ—Ç–µ" (in_progress). –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∏–∑ 5 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–∏–ª —Å—Ç–∞—Ç—É—Å, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç–∫–∞–∑ ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –≥–æ–Ω–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç.

‚ùå **–¢–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω**, –µ—Å–ª–∏ –∑–∞—è–≤–∫–∞ –æ—Å—Ç–∞–ª–∞—Å—å –≤ —Å—Ç–∞—Ç—É—Å–µ "–ù–∞–∑–Ω–∞—á–µ–Ω–∞" (assigned) ‚Äî —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏–ª–∏ —Å—Ç–∞—Ç—É—Å, –∑–∞—â–∏—Ç–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞.

### –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏

–î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è HTML-—Å—Ç—Ä–∞–Ω–∏—Ü –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ —Ç–µ—Å—Ç–∞:

```bash
./race_test.sh --debug
```

–û—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ `/tmp/race_debug/`.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
repair-requests/
‚îú‚îÄ‚îÄ app/                    # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ Http/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Controllers/   # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Middleware/    # Middleware
‚îÇ   ‚îú‚îÄ‚îÄ Models/            # –ú–æ–¥–µ–ª–∏ Eloquent
‚îÇ   ‚îî‚îÄ‚îÄ Providers/         # Service Providers
‚îú‚îÄ‚îÄ config/                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ migrations/        # –ú–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ seeders/          # –°–∏–¥—ã
‚îú‚îÄ‚îÄ public/               # –ü—É–±–ª–∏—á–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
‚îú‚îÄ‚îÄ resources/
‚îÇ   ‚îú‚îÄ‚îÄ views/            # Blade —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îî‚îÄ‚îÄ css/              # –°—Ç–∏–ª–∏
‚îú‚îÄ‚îÄ routes/               # –ú–∞—Ä—à—Ä—É—Ç—ã
‚îú‚îÄ‚îÄ storage/              # –•—Ä–∞–Ω–∏–ª–∏—â–µ
‚îú‚îÄ‚îÄ composer.json         # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ PHP
‚îú‚îÄ‚îÄ Dockerfile           # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ render.yaml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Render.com
‚îî‚îÄ‚îÄ README.md            # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
composer install
npm install

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev

# –°–±–æ—Ä–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
npm run build

# –ó–∞–ø—É—Å–∫ artisan –∫–æ–º–∞–Ω–¥
php artisan migrate
php artisan db:seed
```

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ Docker

–í—Å–µ —Ç–µ—Å—Ç—ã —Å–ª–µ–¥—É–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Docker:

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã
docker-compose up -d

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
docker-compose exec app php artisan test

# –ò–ª–∏ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
docker-compose exec app php artisan test --verbose

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞
docker-compose exec app php artisan test --filter RequestTest

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
docker-compose exec app php artisan test --coverage

# –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ PHPUnit –Ω–∞–ø—Ä—è–º—É—é
docker-compose exec app ./vendor/bin/phpunit
```

#### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ª–æ–∫–∞–ª—å–Ω–æ (–±–µ–∑ Docker)

–ï—Å–ª–∏ PHP –∏ Composer —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
composer install

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
./vendor/bin/phpunit

# –ò–ª–∏ —á–µ—Ä–µ–∑ composer
composer test
```


### üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
